# Техническое Задание

## Описание

Создание/доработка Open-Source парсера для переноса контента из ВКонтакте в Телеграм-канал с возможностью настройки параметров и фильтрации контента.
### Все настройки должны быть реадизованы с помощью переключателей и текстов в  `config.yaml`. То есть для кадого пункта и подпункта сделать (True, False) и/или (list text)
### В ТЗ могут повторяться задачи

## Требования

1. **Видео**
    - Видео предоставляются через API как ссылки с ВК на Телеграм.
    - Реализовать возможность скачивания видео и клипов и публикации в Телеграм.
    - Установить переключатели (True, False) для скачивания видео в конфиге. Учитывая ограничение Телеграм-бота на 50 МБ, использовать библиотеку которая позволяет загружать видео до 1-4 ГБ через API ID и HASH.
    - Сохранение обложки, времени и разрешения видео при скачивании/загрузке в Телеграм.
    - Очистка временной папки после отправки файлов в Телеграм.
    - Реализация на основе `yt_dlp`:
      ```python
      from yt_dlp import YoutubeDL

      URLS = [input('Enter video: ')]
      with YoutubeDL() as ydl:
          ydl.download(URLS)
      ```

2. **Подписи**
    - Убедиться, что каждая публикация содержит подпись (например, "Взято из: Телеграм (https://t.me/telegram)").
    - Подпись может быть по умолчанию пустой.
    - Подпись по умолчанию должна быть формата `Взято из: Телеграм (https://t.me/telegram)`. и указать \n\n в коде что отступы было.

3. **Фильтрация контента**
    - Проверить, не публикуются ли донаты.
    - Гиперссылки в посте должны идти как обычный текст.
    - Если в посте есть ссылка, не публиковать его (через блэклист).
  
- Не публиковать статьи, товары, плейлисты и музыку в Телеграм-канал. Сейчас пересылаются только ссылки.
- Не публиковать (в данный момент некоторые не публикуется (музыка, опросы), или публикуется но в виде ссылок, файл как файл идет но видимо до 50мб ):
    - Товары
    - Статьи
    - Опросы
    - Файлы
    - Музыку
    - Плейлисты

4. **Медиа**
    - Парсер должен пересылать все медиа-вложения.
    - Если вложение - ВК клип, избавиться от водяного знака и тегов в названии.
    - Реализовать переключатели для скачивания или пропуска ВК клипов.

5. **Комментарии**
    - Проверка комментариев автора. Если есть ссылка или гиперссылка, пропускать комментарии.
    - Реализовать переключатели для этой функции.
    - Ссылка проверяется как блэклист анализ делается на `https://`, `vk.me`, `t.me` и так далее если есть ссылки то пропуск если нет то публикуется
    - Если гиперссылка в комментарии то (True, False) есть? пропускаем. нет? публикуем.

6. **Конфигурация**
    - Включить в конфигурацию:
        - Параметры Телеграм и ВКонтакте: `tg_channel`, `tg_bot_token`, `vk_token`, `vk_domain`, `req_count`, `time_to_sleep`, `req_filter`, `single_start`, `skip_ads_posts`, `skip_reposts`, `last_known_post_id`, `skip_copyrighted_posts` и другие.
        - Опции скачивания видео и клипов.
        - Опции подписей (как markdown или обычный текст).

7. **Блэклист и Вайтлист**
    - В блэклисте реализовать фильтрацию по определённым словам с учётом различных форм слова (например, **"ссылк"** будет включать "ссылка", "ссылки", "Ссылку", "ссылочка", "ССЫЛОЧКИ" и т.п.).
    - Аналогично для вайтлиста.

## Управление списками

- Возможность управлять списками (блэклист и вайтлист), при этом учитывать, что список может быть пустым.

## Настройка конфига 

- Наличие комментария в посте от автора:
    - Обычные ссылки: создать список, аналогичный блэклисту. Если находит "https://" и/или "t.me", пост пропускается.
    - Гиперссылки в комментариях: переключение (True, False) для пропуска или публикации.

- Гиперссылки в постах: переключение (True, False) для публикации как гиперссылка или как обычный текст (без markdown, по умолчанию как обычный текст).
- Так же другие вышеперечисленные задачи.

## Итог

Данный парсер должен гибко настраиваться через конфигурационный файл, поддерживать множество опций для фильтрации и публикации контента, а также предоставлять удобные возможности для управления подписками и списками.

## Исходник

- [Ссылка на репозиторий](https://github.com/alcortazzo/vktgbot/tree/v4-dev)
